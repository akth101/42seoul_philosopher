
# philosophers

`philosophers` 프로젝트는 **스레드**, **뮤텍스**를 사용하여 `철학자 문제`를 해결하는 프로젝트입니다.  
자원의 공유와 동기화 문제를 해결하면서 스레드 안전성을 확보하는 방법을 익히는 것이 목표입니다.  

### 목차
- [프로젝트 개요](#프로젝트-개요)
- [철학자 문제 설명](#철학자-문제-설명)
- [구현 세부 사항](#구현-세부-사항)
- [설치 방법](#설치-방법)
- [사용 방법](#사용-방법)

### 1. 프로젝트 개요

이 프로젝트는 다섯 명의 철학자가 한 식탁에 앉아 있으며, 각 철학자는 생각하고, 먹고, 잠자는 활동을 반복해야 합니다.  
각 철학자는 포크 두 개를 사용해야 식사를 할 수 있으며, **뮤텍스**를 통해 포크 자원을 동기화합니다.  
주요 목표는 철학자들이 교착 상태(데드락)에 빠지지 않도록 하는 것입니다.

### 2. 철학자 문제 설명

1. 다섯 명의 철학자가 원형으로 배치된 테이블에 앉아 있습니다.
2. 각 철학자 사이에는 하나의 포크가 놓여 있습니다.
3. 철학자는 식사하기 위해 양쪽의 포크를 모두 들어야 합니다.
4. 철학자는 생각 -> 식사 -> 잠자기 순서로 활동을 반복합니다.
5. 식사 중에는 다른 철학자가 포크를 사용할 수 없으므로, 동기화가 필요합니다.

### 3. 주요 기술적 이슈와 해결 과정  

  #### 3-1) 철학자가 굶어죽어야 하는 상황에서 계속 살아있는 현상 발생  
철학자가 굶어 죽어야 하는 상황에서도 프로그램이 계속 실행되는 현상이 발생했습니다.  
제한 조건:  
철학자 수 - 4
식사 시간 - 310ms
잠자는 시간 - 200ms
굶주림 한계 시간 - 100ms 
    
시나리오:  
첫 번째 그룹(2명의 철학자)이 0 - 310ms 시간 동안 식사  
두 번째 그룹(나머지 2명)이 310 - 620ms 시간 동안 식사  
이때 첫 번째 그룹은 두 번째 그룹의 식사가 끝날 때까지 식사가 불가능
즉 첫 번째 그룹은 다시 식사를 시작하기까지 310ms를 기다려야 하는데 굶주림 한계 시간은 100ms에 불과
따라서 첫 번째 그룹의 철학자들은 굶어 죽어야 하는 상황  
  
원인 분석  
코드 검토 결과, 철학자의 상태에 따른 생존 확인 로직에 차이가 있었습니다:  
eating 상태: 생존 확인 사이클 존재  
sleeping 상태: 생존 확인 사이클 존재  
thinking 상태: 생존 확인 사이클 부재  
이로 인해 thinking 상태에서는 철학자가 굶어 죽어야 하는 상황에서도 이를 감지하지 못하는 문제가 발생했습니다.  

해결 방안  
thinking 상태에서도 생존 확인 사이클을 구현하여 문제를 해결했습니다  

결론
이 경험을 통해 멀티스레드 프로그램에서 상태 감시의 일관성이 얼마나 중요한지 배울 수 있었습니다.

## 4. 설치 방법

터미널에서 이 저장소를 클론합니다.
    ```bash
    git clone https://github.com/jmsmg/philosophers.git
    cd philosophers
    ```
프로젝트를 빌드합니다.
    ```bash
    make
    ```
컴파일이 완료되면 `philosophers` 실행 파일이 생성됩니다.

## 5. 사용 방법
```bash
./philosophers <철학자 수> <식사 시간> <잠자는 시간> <굶주림 한계 시간> [최대 식사 횟수]
```
예를 들어, 5명의 철학자가 식사 시간 200ms, 잠자는 시간 100ms, 굶주림 한계 시간 800ms로 설정된 경우:

```bash
./philosophers 5 200 100 800
```
- `철학자 수`: 철학자의 수 (기본 5)
- `식사 시간`: 철학자가 식사를 마치기까지 걸리는 시간
- `잠자는 시간`: 철학자가 잠자기 상태에 있는 시간
- `굶주림 한계 시간`: 철학자가 일정 시간 동안 식사를 하지 않을 경우 죽는 한계 시간
- `[최대 식사 횟수]`: (선택 사항) 철학자가 식사할 최대 횟수. 이 횟수에 도달하면 철학자는 더 이상 식사하지 않습니다.
